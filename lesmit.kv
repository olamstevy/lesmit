#: import WipeTransition kivy.uix.screenmanager.WipeTransition


# Dynamic Classes are created here
<WlcPgCaroCtrl>:
    group: 'wlcpgcaroctrl'
    size_hint: None, None
    size: dp(20), dp(20)
    radio_icon_normal: 'checkbox-blank-circle-outline'
    radio_icon_down: 'circle-slice-8'
    checkbox_icon_normal: 'checkbox-blank-circle-outline'
    checkbox_icon_down: 'circle-slice-8'
    color_active: (1, 1, 1, 1)
    color_inactive: (1, 1, 1, 1)

<WlcPgLbl>:
    halign: 'center'
    size_hint: 0.7, None
    font_name: 'fonts/ARLRDBD'
    line_height: sp(1.3)
    color: (1, 1, 1, 1)
    markup: True
    bold: False
    font_size: sp(25)
    pos_hint: {'center_x': 0.5, 'center_y': 0.5}

<LoginSignUpTextField>:
    fill_color_normal: (1, 1, 1, .7)
    fill_color_focus: (1, 1, 1, .9)
    hint_text_color_normal: (0, 0, 0, 1)
    hint_text_color_focus: (0, 0, 0, 1)
    icon_left_color_normal: (0, 0, 0, 1)
    icon_left_color_focus: (0, 0, 0, 1)
    text_color_normal: (0, 0, 0, 1)
    text_color_focus: (0, 0, 0, 1)
    error_color: (.1, 0, 0, .8)
    radius: 20, 20, 20, 20
    size_hint: 0.8, 0.1
    font_size: sp(17)
    mode: 'fill'
    required: True
    helper_text_mode: 'on_error'
    active_line: False

<ProfilePicture>:
    icon: 'images/transparent.png'
    
    canvas.before:
        Color:
            rgba: (0, 0, 0, 1)
        Ellipse:
            pos: self.pos
            size: self.size
    
    canvas.after:
        Color:
            rgba: (1, 1, 1, 1)
        Ellipse:
            source: 'images/logo.png'
            pos: self.pos
            size: self.size

#Dynamic Classes ends here



ScreenManager:
    id: scrmgr
    transition: WipeTransition()
    WelcomePage:
    LoginPage:
    SignupPage:
    HomePage:
    ChatPage:
    SettingsPage:
    BioPage:



<SettingsPage>:
    name: 'settingspage'


<BioPage>:
    name: 'biopage'


<ChatPage>:
    name: 'chatpage'


<HomePage>:
    name: 'homepage'
    id: homepg
    all_chat_list: all_chat_list
    MDBoxLayout:
        orientation: 'vertical'
        MDTopAppBar:
            title: 'Lesmit Chat App'
            left_action_items: [["images/logo.png", lambda x: None]]
            md_bg_color: (.1, .2, .2, 1)

        MDScrollView:
            MDList:
                id: all_chat_list

<SignupPage>:
    name: 'signuppage'
    MDFloatLayout:
        size_hint: 1, 1
        canvas.before:
            Color:
                rgba: (.4, .5, .5, 1)
            Rectangle:
                pos: self.pos
                size: self.size

        MDLabel:
            pos_hint: {'center_x': .5, 'center_y': .9}
            size_hint_x: .8
            text: 'Please enter details to Signup'
            color: (0, 0, 0, 1)
            font_name: 'fonts/seguihis'
            halign: 'center'
            font_size: sp(21)
        
        LoginSignUpTextField:
            id: signup_mail_txtfield
            pos_hint: {'center_x': .5, 'center_y': .8}
            hint_text: 'Email address'
            font_name: 'fonts/seguihis'
            icon_left: 'email'
            validator: 'email'
        
        LoginSignUpTextField:
            id: signup_mail_txtfield
            pos_hint: {'center_x': .5, 'center_y': .65}
            hint_text: 'Phone Number'
            font_name: 'fonts/seguihis'
            icon_left: 'phone'
            validator: 'phone'
        
        LoginSignUpTextField:
            id: signup_pswd_txtfield
            pos_hint: {'center_x': .5, 'center_y': .5}
            hint_text: 'Password'
            icon_left: 'key-variant'
            password: True
            max_text_length: 15
            max_length_text_color: (.3, 0, 0, 1)
            on_text:
                if len(self.text) < 5 : self.error = True
                if len(self.text) >= 5 and len(self.text) <= 15: self.error = False
        
        MDIconButton:
            icon: "eye"
            pos_hint: {'center_x': .83, "center_y": .5}
            theme_text_color: 'Hint'
            on_release:
                self.icon = "eye" if self.icon == "eye-off" else "eye-off"
                signup_pswd_txtfield.password = False if signup_pswd_txtfield.password is True else True
        
        LoginSignUpTextField:
            id: confirm_signup_pswd_txtfield
            pos_hint: {'center_x': .5, 'center_y': .35}
            hint_text: 'Confirm Password'
            icon_left: 'key-variant'
            password: True
            max_text_length: 15
            max_length_text_color: (.3, 0, 0, 1)
            on_text:
                if len(self.text) < 5 : self.error = True
                if len(self.text) >= 5 and len(self.text) <= 15: self.error = False
        
        MDIconButton:
            icon: "eye"
            pos_hint: {'center_x': .83, "center_y": .35}
            theme_text_color: 'Hint'
            on_release:
                self.icon = "eye" if self.icon == "eye-off" else "eye-off"
                confirm_signup_pswd_txtfield.password = False if confirm_signup_pswd_txtfield.password \
                is True else True

        # Button submit when true for both fields
        MDFlatButton:
            text: 'Signup'
            _radius: dp(20)
            size_hint: 0.8, .1
            md_bg_color: (.2, .3, .3, 1)
            text_color: (1, 1, 1, 1)
            theme_text_color: "Custom"
            font_name: 'fonts/futura md bt medium'
            font_size: sp(20)
            pos_hint: {'center_x':.5, 'center_y':.2}
            on_release:
                if not signup_mail_txtfield.error and not signup_pswd_txtfield.error: \
                root.verify_signup_request(signup_mail_txtfield.text, signup_pswd_txtfield.text); \
                signup_mail_txtfield.text, signup_pswd_txtfield.text = '', ''

        MDFlatButton:
            pos_hint: {'center_x': .5, 'center_y': .1}
            text: '[u]Already have an account? Sign in...[/u]'
            theme_text_color: 'Custom'
            text_color: (.05, .05, .4, 1)
            markup: True
            font_name: 'fonts/segoeuii'
            font_size: sp(13)
            on_release: root.manager.current = 'loginpage'


<LoginPage>:
    name: 'loginpage'
    MDFloatLayout:
        size_hint: 1, 1
        canvas.before:
            Color:
                rgba: (.2, .3, .3, 1)
            Rectangle:
                pos: self.pos
                size: self.size

        MDLabel:
            pos_hint: {'center_x': .5, 'center_y': .68}
            size_hint_x: .8
            text: 'Please enter details to login'
            color: (1, 1, 1, 1)
            font_name: 'fonts/seguihis'
            halign: 'center'
            font_size: sp(21)
        
        LoginSignUpTextField:
            id: login_mail_txtfield
            pos_hint: {'center_x': .5, 'center_y': .55}
            hint_text: 'Email Address'
            font_name: 'fonts/seguihis'
            icon_left: 'email'
            validator: 'email'
            helper_text: 'Please enter a valid email address'
        
        LoginSignUpTextField:
            id: login_pswd_txtfield
            pos_hint: {'center_x': .5, 'center_y': .4}
            hint_text: 'Password'
            icon_left: 'key-variant'
            password: True
            max_text_length: 15
            max_length_text_color: (.3, 0, 0, 1)
            on_text:
                if len(self.text) < 5 : self.error = True
                if len(self.text) >= 5 and len(self.text) <= 15: self.error = False
        
        MDIconButton:
            icon: "eye"
            pos_hint: {'center_x': .83, "center_y": .4}
            theme_text_color: 'Hint'
            on_release:
                self.icon = "eye" if self.icon == "eye-off" else "eye-off"
                login_pswd_txtfield.password = False if login_pswd_txtfield.password is True else True

        # Button submit when true for both fields
        MDFlatButton:
            text: 'Login'
            _radius: dp(20)
            size_hint: .8, .1
            md_bg_color: (.0, .1, .1, 1)
            text_color: (1, 1, 1, 1)
            theme_text_color: "Custom"
            font_name: 'fonts/futura md bt medium'
            font_size: sp(20)
            pos_hint: {'center_x':.5, 'center_y':.25}
            on_release:
                if not login_mail_txtfield.error and not login_pswd_txtfield.error: \
                root.verify_login_request(login_mail_txtfield.text, login_pswd_txtfield.text); \
                login_mail_txtfield.text, login_pswd_txtfield.text = '', ''

        MDFlatButton:
            pos_hint: {'center_x': .5, 'center_y': .15}
            text: '[u]Don\'t have an account? Create One...[/u]'
            theme_text_color: 'Custom'
            text_color: (.65, .65, 1, 1)
            markup: True
            font_name: 'fonts/segoeuii'
            font_size: sp(13)
            on_release: root.manager.current = 'signuppage'


<WelcomePage>:
    name: 'welcomepage'
    MDFloatLayout:
        size_hint: 1, 1
        canvas.before:
            Color:
                rgba: (0, .05, .05, 1)
            Rectangle:
                pos: self.pos
                size: self.size
        
        MDCarousel:
            size_hint: 1, 0.6
            pos_hint: {'center_x': 0.5, 'center_y': 0.7}
            id: welcomepagecarousel
            scroll_timeout: 0
            loop: True

            WlcPgLbl:
                text: 'Lesmit helps you reach your [i]Family, Friends and Colleagues[/i] with just one click...'
            
            WlcPgLbl:
                text: 'Start with us today and enjoy the massive benefits of using Lesmit'
            
            WlcPgLbl:
                text: 'Dont enjoy alone, share your experience with others.'
            
            WlcPgLbl:
                text: 'Thank you for choosing Lesmit!'
            
            MDFloatLayout:
                MDLabel:
                    text: 'Do you have a LESMIT account?'
                    color: (1, 1, 1, 1)
                    font_name: 'fonts/seguihis'
                    halign: 'center'
                    font_size: sp(30)
                    pos_hint: {'center_x':.5, 'center_y':.6}

                MDIconButton:
                    icon: 'checkbox-marked-circle'
                    user_font_color: (0, 0, 0, 0)
                    user_font_size: sp(45)
                    pos_hint: {'center_x': 0.3, 'center_y':0.3}
                    md_bg_color: (1, 1, 1, .1)
                    theme_text_color: 'Custom'
                    text_color: (1, 1, 1, 1)
                    on_release: root.manager.current = 'loginpage'

                MDIconButton:
                    icon: 'alpha-x-circle'
                    user_font_size: sp(45)
                    pos_hint: {'center_x': 0.7, 'center_y':0.3}
                    md_bg_color: (.6, .4, .4, .2)
                    theme_text_color: 'Custom'
                    text_color: (1, 1, 1, 1)
                    on_release: root.manager.current = 'signuppage'

            
        WlcPgCaroCtrl:
            active: True
            pos_hint: {"center_x":.135 , "center_y":.35}
            id: wlc_pg_crsl_rd_0
            on_release: welcomepagecarousel.load_slide(welcomepagecarousel.slides[0])
        WlcPgCaroCtrl:
            pos_hint: {"center_x":.315, "center_y":.35}
            id: wlc_pg_crsl_rd_1
            on_release: welcomepagecarousel.load_slide(welcomepagecarousel.slides[1]); wlc_pg_crsl_rd_1.active = True
        WlcPgCaroCtrl:
            pos_hint: {"center_x":.495, "center_y":.35}
            id: wlc_pg_crsl_rd_2
            on_press: self.active = True
            on_release: welcomepagecarousel.load_slide(welcomepagecarousel.slides[2])
        WlcPgCaroCtrl:
            pos_hint: {"center_x":.675, "center_y":.35}
            id: wlc_pg_crsl_rd_3
            on_press: self.active = True
            on_release: welcomepagecarousel.load_slide(welcomepagecarousel.slides[3])
        WlcPgCaroCtrl:
            pos_hint: {"center_x":.855, "center_y":.35}
            id: wlc_pg_crsl_rd_4
            on_press: self.active = True
            on_release: welcomepagecarousel.load_slide(welcomepagecarousel.slides[4])
        

        MDIconButton:
            icon: 'arrow-left'
            pos_hint: {'center_x': 0.3, 'center_y': .2}
            md_bg_color: (1, 1, 1, .1)
            size: sp(50), sp(50)
            theme_text_color: 'Custom'
            text_color: (1, 1, 1, 1)
            on_release:
                wlc_pg_crsl_rd_lst = [wlc_pg_crsl_rd_0, wlc_pg_crsl_rd_1, \
                wlc_pg_crsl_rd_2, wlc_pg_crsl_rd_3, wlc_pg_crsl_rd_4]
                (wlc_pg_crsl_rd_lst[welcomepagecarousel.index - 1]).active = True
                welcomepagecarousel.load_previous()

        MDIconButton:
            icon: 'arrow-right'
            pos_hint: {'center_x': 0.7, 'center_y': .2}
            md_bg_color: (1, 1, 1, .1)
            user_font_size: sp(25)
            theme_text_color: 'Custom'
            text_color: (1, 1, 1, 1)
            on_release:
                wlc_pg_crsl_rd_lst = [wlc_pg_crsl_rd_0, wlc_pg_crsl_rd_1, \
                wlc_pg_crsl_rd_2, wlc_pg_crsl_rd_3, wlc_pg_crsl_rd_4]
                if welcomepagecarousel.index + 1 > len(wlc_pg_crsl_rd_lst) - 1: \
                wlc_pg_crsl_rd_lst[0].active = True
                else: (wlc_pg_crsl_rd_lst[welcomepagecarousel.index + 1]).active = True
                welcomepagecarousel.load_next()